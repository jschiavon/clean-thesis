\usepackage{lipsum}

% Languages
\usepackage[english]{babel}
\usepackage{csquotes}

% Colors
\usepackage[usenames,dvipsnames,table]{xcolor}
\definecolor{UnipdRed}{RGB}{155,0,20}
\definecolor{Trasparentino}{gray}{0.35}

% Fonts
\usepackage[no-math]{fontspec}
\usepackage[OT1]{eulervm}
\usepackage{microtype,ifthen}

\directlua{
  fonts.handlers.otf.addfeature{
    name = "wxyz",
    type = "alternate",
    data = {
      ["one.osf"] = "one.01",
      ["one.tosf"] = "one.tosf01",
    },
  }
}

\setmainfont{EB Garamond}[Numbers={OldStyle,Proportional}, RawFeature={%
        +calt,   % *Contextual alternates
        +clig,  % *contextual ligatures
        +ccmp,  % *composition & decomposition
        +tlig,  % 'tex-ligatures': `` '' -- --- !` ?` << >>
        +cv06,  % narrow guillemets
        +wxyz % alternate 1
    }]
\newfontface\chapterNumber[Scale=2.5,Color=Trasparentino,Numbers=Lining]{EBGaramond}
\newfontfamily{\smallcaps}[RawFeature={+c2sc,+scmp}]{EB Garamond}
\newfontfamily{\swash}[RawFeature={+swsh}]{EB Garamond}

\RequirePackage{textcase} % for \MakeTextUppercase
\makeatletter
\newcommand{\ct@altfont}{}
\newcommand{\ct@caps}{\ct@altfont\scshape}

\DeclareRobustCommand{\spacedallcaps}[1]{{\addfontfeature{LetterSpace=18.0}\ct@caps\MakeTextUppercase{#1}}}
\DeclareRobustCommand{\spacedlowsmallcaps}[1]{{\addfontfeatures{LetterSpace=14.0}\ct@caps\MakeTextLowercase{#1}}}
\makeatother

% Math stuff
\usepackage{amsmath,amssymb,amsfonts,amsthm,braket,cancel}

\newtheoremstyle{definition}{}{}{\itshape}{\parindent}{\scshape}{}{1em}{\thmname{#1}\thmnumber{ #2}:}
\newtheoremstyle{theorem}{}{}{}{\parindent}{\scshape}{}{1em}{\thmname{#1}\thmnumber{ #2}:}
\theoremstyle{theorem}
\newtheorem{lemma}{Lemma}[section]
\newtheorem{corollary}[lemma]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}{Definition}[section]

\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator{\logm}{Log}
\DeclareMathOperator{\tr}{Tr}
\newcommand{\norm}[2][]{\left\Vert#2\right\Vert_{#1}}
\newcommand{\abs}[1]{\left\vert#1\right\vert}
\newcommand{\spd}[1][]{\mathcal{S}_{#1}^+}
\newcommand{\orth}[1][]{\mathcal{O}_{#1}}
\newcommand{\real}[1][]{\mathbb{R}^{#1}}
\newcommand{\transp}[1]{#1^\top}
\newcommand{\inv}[1]{#1^{-1}}

% Layout, graphics and tables
\usepackage[bottom=4.5cm]{geometry}
%    \geometry{left=3.5cm, right=3.5cm, top=3.5cm, bottom=4cm, bindingoffset=0.5cm}
\usepackage{setspace}
    \onehalfspacing
    \AfterTOCHead{\singlespacing}
\usepackage{graphicx}
    \graphicspath{{_Images/}}
\usepackage{booktabs,caption,subcaption}
\addtokomafont{caption}{\small}
\setkomafont{captionlabel}{\scshape}
\usepackage{pgfplots}

\newcommand{\gotoclearpage}{\cleardoublepage}

% Headers
\usepackage[automark]{scrlayer-scrpage}
\clearpairofpagestyles
\makeatletter
\let\MakeMarkcase\spacedlowsmallcaps
\renewcommand{\chaptermark}[1]{\markboth{\spacedlowsmallcaps{#1}}{\spacedlowsmallcaps{#1}}}
\renewcommand{\sectionmark}[1]{\markright{\textsc{\MakeTextLowercase{\thesection}}\hspace{1em} \spacedlowsmallcaps{#1}}}
\lehead{\mbox{\llap{\small\thepage\kern1em\color{Trasparentino}\vline}\color{Trasparentino}\hspace{0.5em}\headmark\hfil}}
\rohead{\mbox{\hfil{\color{Trasparentino}\headmark\hspace{0.5em}}\rlap{\small{\color{Trasparentino}\vline}\kern1em\thepage}}}
\rofoot[\mbox{\makebox[0pt][l]{\kern1em\thepage}}]{}
\renewcommand{\headfont}{\small}
\renewcommand{\pnumfont}{\small}
\clearscrplain
\def\toc@heading{\chapter*{\contentsname}
    \@mkboth{\spacedlowsmallcaps{\contentsname}}{\spacedlowsmallcaps{\contentsname}}}
\makeatother

\cfoot[\pagemark]{}


% Chapters, sections and stuff
\setkomafont{disposition}{\rmfamily\normalfont}
\setkomafont{chapter}{\huge\scshape}
\setkomafont{section}{\Large\scshape}
\setkomafont{subsection}{\large\itshape}

\renewcommand*{\chapterformat}{\makebox[0pt][r]{\chapterNumber\thechapter\hspace{10pt}\vline\hspace{10pt}}}
\renewcommand*{\sectionformat}{\textsc{\thesection\autodot}\enskip}
\renewcommand*{\subsectionformat}{\textsc{\thesubsection\autodot}\enskip}
\renewcommand{\thesection}{\textsc{\roman{section}}}
\renewcommand{\thesubsection}{\thesection.\roman{subsection}}
\renewcommand{\thesubsubsection}{\thesubsection.\roman{subsubsection}}

\RedeclareSectionCommands[
    tocraggedpagenumber,
    toclinefill=\qquad
    ]{part}

\RedeclareSectionCommands[
    tocraggedpagenumber,
    toclinefill=\qquad,
    afterindent=false,
    beforeskip=5\baselineskip,
    afterskip=3\baselineskip
    ]{chapter}

\RedeclareSectionCommands[
    tocraggedpagenumber,
    toclinefill=\qquad,
    afterindent=false,
    beforeskip=2\baselineskip,
    afterskip=\baselineskip
    ]{section}
    
\RedeclareSectionCommands[
    tocraggedpagenumber,
    toclinefill=\qquad,
    afterindent=false,
    beforeskip=1.5\baselineskip,
    afterskip=0.75\baselineskip
    ]{subsection}
    
\RedeclareSectionCommands[
    tocraggedpagenumber,
    toclinefill=\qquad
    ]{subsubsection}

\newcommand{\scref}[1]{\textsc{\ref{#1}}}
\newcommand{\figref}[1]{Figure~\scref{#1}}

% Table of contents
\setkomafont{chapterentry}{\scshape}
\setcounter{tocdepth}{\sectiontocdepth}

% Document data
\newcommand{\myTitle}{Thesis title}
\newcommand{\myShortTitle}{Thesis shortitle}
\newcommand{\mySubtitle}{Thesis subtitle}
\newcommand{\myName}{Author Name}
\newcommand{\myDate}{2021}
\newcommand{\myProf}{\emph{prof}. Supervisor name}
\newcommand{\myFaculty}{Course name}
\newcommand{\myDepartment}{Department name}
\newcommand{\myUni}{Universit√† degli Studi di Padova}
\newcommand{\myLocation}{Padova}


% Bibliography
\usepackage[style=numeric-comp,
                    backend=biber,
                    backref=false,
                    maxcitenames=3,
                    hyperref=true,
                    url=false,
                    doi=false,
                    isbn=false,
                    date=year
                    ]{biblatex}
\addbibresource{biblio.bib}


% Hyperref setup
\usepackage{hyperref}
\hypersetup{
    pdftitle={\myTitle},    % title
    pdfauthor={\myName},     % author
    colorlinks=true,       % false: boxed links (set box color with linkbordercolor)
    breaklinks,				% allow linebreaks on links
    linkcolor=MidnightBlue,   % color of internal links
    citecolor=TealBlue,       % color of links to bibliography
    urlcolor=Sepia           % color of external links
}
\renewcommand\UrlFont{\rmfamily}

